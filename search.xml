<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>æˆ‘çš„ç¬¬ä¸€ç¯‡blog</title>
    <url>/2025/12/11/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87blog/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä½ å¥½ï¼Œä¸–ç•Œ ğŸ‘‹  </p>
<hr>
<h2 id="ğŸ§ -å…³äºæˆ‘"><a href="#ğŸ§ -å…³äºæˆ‘" class="headerlink" title="ğŸ§  å…³äºæˆ‘"></a>ğŸ§  å…³äºæˆ‘</h2><p>æˆ‘æ˜¯å‰æ—å¤§å­¦ <strong>ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸š</strong> çš„äºŒå¹´çº§å­¦ç”Ÿï¼Œç›®å‰ä¸»è¦ä¸“æ³¨äº <strong>CTF</strong> ä¸­ <strong>Crypto</strong> æ–¹å‘çš„å­¦ä¹ ä¸åˆ†äº«ã€‚</p>
<h2 id="ğŸ“-è¿‘æœŸåŠ¨æ€"><a href="#ğŸ“-è¿‘æœŸåŠ¨æ€" class="headerlink" title="ğŸ“ è¿‘æœŸåŠ¨æ€"></a>ğŸ“ è¿‘æœŸåŠ¨æ€</h2><ul>
<li>åœ¨æˆ‘çš„åšå®¢æŒç»­æ›´æ–° <strong>CTF Crypto é¢˜ç›®çš„ Writeups</strong>ï¼Œè®°å½•è§£é¢˜æ€è·¯ä¸çŸ¥è¯†ç‚¹æ€»ç»“ã€‚</li>
<li>æ­£åœ¨å°è¯•å…¥é—¨ <strong>AI å®‰å…¨</strong>ï¼Œè®¡åˆ’é€æ­¥å¼€å±•ä¸€äº›å°é¡¹ç›®ï¼Œæ¢ç´¢æœºå™¨å­¦ä¹ ä¸å®‰å…¨çš„äº¤å‰é¢†åŸŸã€‚</li>
</ul>
<h2 id="ğŸš§-æœªæ¥è®¡åˆ’"><a href="#ğŸš§-æœªæ¥è®¡åˆ’" class="headerlink" title="ğŸš§ æœªæ¥è®¡åˆ’"></a>ğŸš§ æœªæ¥è®¡åˆ’</h2><p>æˆ‘ä¼šç»§ç»­æ›´æ–°CTFç›¸å…³çš„å†…å®¹ï¼Œå¹¶é€æ¸åŠ å…¥ AI å®‰å…¨çš„å­¦ä¹ ç¬”è®°ä¸å®è·µè®°å½•ã€‚<br><strong>æ¬¢è¿å…³æ³¨ï¼Œä¸€èµ·äº¤æµï¼Œæ•¬è¯·æœŸå¾…ï¼</strong></p>
<hr>
<p><em>ğŸ“¬ è”ç³»é‚®ç®±ï¼š[<a href="mailto:&#x33;&#53;&#x31;&#x33;&#x37;&#50;&#x38;&#50;&#48;&#x33;&#64;&#x71;&#x71;&#x2e;&#x63;&#x6f;&#x6d;">&#x33;&#53;&#x31;&#x33;&#x37;&#50;&#x38;&#50;&#48;&#x33;&#64;&#x71;&#x71;&#x2e;&#x63;&#x6f;&#x6d;</a>]</em></p>
]]></content>
  </entry>
  <entry>
    <title>Find the lattice</title>
    <url>/2025/12/12/Find-the-lattice/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Find-the-Lattice"><a href="#Find-the-Lattice" class="headerlink" title="Find the Lattice"></a>Find the Lattice</h1><h2 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h2><p>è¯¥æŒ‘æˆ˜æ¶‰åŠä¸€ä¸ªåŸºäºæ ¼çš„åŠ å¯†ç³»ç»Ÿã€‚åŠ å¯†è¿‡ç¨‹ä½¿ç”¨å…¬é’¥ <code>(q, h)</code> åŠ å¯†æ¶ˆæ¯ <code>m</code>ï¼Œç”Ÿæˆå¯†æ–‡ <code>e</code>ã€‚è§£å¯†éœ€è¦ç§é’¥ <code>(f, g)</code>ã€‚ä»ä»£ç ä¸­å¯çŸ¥ï¼ŒåŠ å¯†ç®—æ³•æ»¡è¶³å…³ç³»å¼ <code>f * h â‰¡ g (mod q)</code>ï¼Œå³å­˜åœ¨æ•´æ•° <code>k</code> ä½¿å¾— <code>f * h = g + k * q</code>ã€‚è¿™å¯ä»¥è¡¨ç¤ºä¸ºå‘é‡å…³ç³»ï¼š<br>[<br>f \cdot (1, h) - k \cdot (0, q) &#x3D; (f, g)<br>]<br>å› æ­¤ï¼Œå‘é‡ <code>(f, g)</code> æ˜¯ç”±åŸºå‘é‡ <code>(1, h)</code> å’Œ <code>(0, q)</code> å¼ æˆçš„äºŒç»´æ ¼ä¸­çš„ä¸€ä¸ªçŸ­å‘é‡ã€‚ç”±äº <code>f</code> å’Œ <code>g</code> çš„å¤§å°çº¦ä¸º <code>O(\sqrt&#123;q&#125;)</code>ï¼Œè€Œæ ¼çš„è¡Œåˆ—å¼ä¸º <code>q</code>ï¼Œå› æ­¤ <code>(f, g)</code> å¾ˆå¯èƒ½æ˜¯æ ¼ä¸­çš„ä¸€ä¸ªçŸ­å‘é‡ï¼Œå¯ä»¥é€šè¿‡æ ¼çº¦åŒ–ç®—æ³•æ‰¾åˆ°ã€‚</p>
<h2 id="æ”»å‡»åŸç†"><a href="#æ”»å‡»åŸç†" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h2><p>ä½¿ç”¨é«˜æ–¯æ ¼çº¦åŒ–ç®—æ³•ï¼ˆGaussian Lattice Reductionï¼‰å¯ä»¥å°†æ ¼åŸºçº¦åŒ–ä¸ºæœ€çŸ­åŸºå‘é‡ã€‚åœ¨äºŒç»´æ ¼ä¸­ï¼Œè¯¥ç®—æ³•èƒ½é«˜æ•ˆæ‰¾åˆ°æœ€çŸ­å‘é‡ã€‚é€šè¿‡å°†åŸºå‘é‡ <code>v1 = (1, h)</code> å’Œ <code>v2 = (0, q)</code> çº¦åŒ–ï¼Œæˆ‘ä»¬æœ‰æœ›å¾—åˆ°å‘é‡ <code>(f, g)</code>ï¼Œä»è€Œæ¢å¤ç§é’¥ã€‚</p>
<h2 id="ç®—æ³•æ­¥éª¤"><a href="#ç®—æ³•æ­¥éª¤" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h2><p>é«˜æ–¯æ ¼çº¦åŒ–ç®—æ³•æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆå§‹åŒ–ä¸¤ä¸ªåŸºå‘é‡ <code>v1</code> å’Œ <code>v2</code>ï¼Œå…¶ä¸­ <code>v1</code> ä¸ºè¾ƒçŸ­çš„å‘é‡ã€‚</li>
<li>è®¡ç®—æŠ•å½±ç³»æ•° <code>m = round( (v2 Â· v1) / (v1 Â· v1) )</code>ã€‚</li>
<li>å¦‚æœ <code>m â‰  0</code>ï¼Œåˆ™æ›´æ–° <code>v2 = v2 - m * v1</code>ã€‚</li>
<li>äº¤æ¢ <code>v1</code> å’Œ <code>v2</code>ï¼Œé‡å¤æ­¥éª¤2-3ï¼Œç›´åˆ° <code>v2</code> ä¸å†å˜åŒ–ã€‚</li>
<li>æœ€ç»ˆå¾—åˆ°çš„ <code>v1</code> å’Œ <code>v2</code> æ˜¯çº¦åŒ–åçš„åŸºï¼Œå…¶ä¸­è¾ƒçŸ­çš„å‘é‡å³ä¸º <code>(f, g)</code>ã€‚</li>
</ol>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>ä»¥ä¸‹Pythonä»£ç å®ç°äº†æ”»å‡»è¿‡ç¨‹ï¼š</p>
<ul>
<li>ä» <code>output.txt</code> è¯»å–å…¬é’¥ <code>(q, h)</code> å’Œå¯†æ–‡ <code>e</code>ã€‚</li>
<li>ä½¿ç”¨é«˜æ–¯æ ¼çº¦åŒ–æ‰¾åˆ°ç§é’¥ <code>(f, g)</code>ã€‚</li>
<li>ä½¿ç”¨è§£å¯†å‡½æ•°æ¢å¤æ˜æ–‡ <code>m</code>ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gaussian_reduction</span>(<span class="params">v1, v2</span>):</span><br><span class="line">    <span class="comment"># ç¡®ä¿ v1 æ˜¯è¾ƒçŸ­çš„å‘é‡</span></span><br><span class="line">    <span class="keyword">if</span> math.sqrt(v1[<span class="number">0</span>]**<span class="number">2</span> + v1[<span class="number">1</span>]**<span class="number">2</span>) &gt; math.sqrt(v2[<span class="number">0</span>]**<span class="number">2</span> + v2[<span class="number">1</span>]**<span class="number">2</span>):</span><br><span class="line">        v1, v2 = v2, v1</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># è®¡ç®—æŠ•å½±ç³»æ•°</span></span><br><span class="line">        m = <span class="built_in">round</span>((v2[<span class="number">0</span>]*v1[<span class="number">0</span>] + v2[<span class="number">1</span>]*v1[<span class="number">1</span>]) / (v1[<span class="number">0</span>]**<span class="number">2</span> + v1[<span class="number">1</span>]**<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># æ›´æ–° v2</span></span><br><span class="line">        v2 = (v2[<span class="number">0</span>] - m * v1[<span class="number">0</span>], v2[<span class="number">1</span>] - m * v1[<span class="number">1</span>])</span><br><span class="line">        <span class="comment"># äº¤æ¢ v1 å’Œ v2</span></span><br><span class="line">        v1, v2 = v2, v1</span><br><span class="line">    <span class="keyword">return</span> v1, v2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">q, h, f, g, e</span>):</span><br><span class="line">    a = (f * e) % q</span><br><span class="line">    <span class="comment"># è®¡ç®— f æ¨¡ g çš„é€†å…ƒ</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f_inv = <span class="built_in">pow</span>(f, -<span class="number">1</span>, g)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    m = (a * f_inv) % g</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä» output.txt è¯»å–æ•°æ®</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">    <span class="comment"># è§£æå…¬é’¥å’Œå¯†æ–‡</span></span><br><span class="line">    lines = data.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    q_h_line = lines[<span class="number">0</span>].split(<span class="string">&#x27;Public key:&#x27;</span>)[<span class="number">1</span>].strip()</span><br><span class="line">    q_h = <span class="built_in">eval</span>(q_h_line)</span><br><span class="line">    q, h = q_h</span><br><span class="line">    e_line = lines[<span class="number">1</span>].split(<span class="string">&#x27;Encrypted Flag:&#x27;</span>)[<span class="number">1</span>].strip()</span><br><span class="line">    e = <span class="built_in">int</span>(e_line)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ ¼åŸºå‘é‡</span></span><br><span class="line">v1 = (<span class="number">1</span>, h)</span><br><span class="line">v2 = (<span class="number">0</span>, q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åº”ç”¨é«˜æ–¯çº¦åŒ–</span></span><br><span class="line">v1_red, v2_red = gaussian_reduction(v1, v2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾ƒçŸ­çš„å‘é‡åº”è¯¥æ˜¯ (f, g)</span></span><br><span class="line"><span class="keyword">if</span> math.sqrt(v1_red[<span class="number">0</span>]**<span class="number">2</span> + v1_red[<span class="number">1</span>]**<span class="number">2</span>) &lt; math.sqrt(v2_red[<span class="number">0</span>]**<span class="number">2</span> + v2_red[<span class="number">1</span>]**<span class="number">2</span>):</span><br><span class="line">    f, g = v1_red</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    f, g = v2_red</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†æ¶ˆæ¯</span></span><br><span class="line">m = decrypt(q, h, f, g, e)</span><br><span class="line"><span class="keyword">if</span> m <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag.decode())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Decryption failed. Trying alternative vector...&quot;</span>)</span><br><span class="line">    <span class="comment"># å¦‚æœå¤±è´¥ï¼Œå°è¯•å¦ä¸€ä¸ªå‘é‡</span></span><br><span class="line">    <span class="keyword">if</span> math.sqrt(v1_red[<span class="number">0</span>]**<span class="number">2</span> + v1_red[<span class="number">1</span>]**<span class="number">2</span>) &lt; math.sqrt(v2_red[<span class="number">0</span>]**<span class="number">2</span> + v2_red[<span class="number">1</span>]**<span class="number">2</span>):</span><br><span class="line">        f, g = v2_red</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f, g = v1_red</span><br><span class="line">    f = <span class="built_in">abs</span>(f)</span><br><span class="line">    g = <span class="built_in">abs</span>(g)</span><br><span class="line">    m = decrypt(q, h, f, g, e)</span><br><span class="line">    <span class="keyword">if</span> m <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        flag = long_to_bytes(m)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag.decode())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Decryption still failed. Check the lattice reduction.&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æŒ‘æˆ˜å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ ¼çº¦åŒ–æ”»å‡»åŸºäºæ ¼çš„åŠ å¯†ç³»ç»Ÿã€‚é€šè¿‡å°†åŠ å¯†é—®é¢˜è½¬åŒ–ä¸ºæ ¼ä¸­çš„çŸ­å‘é‡é—®é¢˜ï¼Œå¹¶ä½¿ç”¨é«˜æ–¯çº¦åŒ–ç®—æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æ¢å¤ç§é’¥å¹¶è§£å¯†æ¶ˆæ¯ã€‚è¿™ç§æ–¹æ³•åœ¨å¯†ç åˆ†æä¸­å¸¸è§ï¼Œå¼ºè°ƒäº†è®¾è®¡åŠ å¯†ç³»ç»Ÿæ—¶é¿å…çº¿æ€§ç»“æ„çš„é‡è¦æ€§ã€‚</p>
]]></content>
      <categories>
        <category>CRYPTO</category>
      </categories>
      <tags>
        <tag>crypto</tag>
      </tags>
  </entry>
</search>
